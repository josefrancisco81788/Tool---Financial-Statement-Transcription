<?xml version="1.0" encoding="utf-8"?><testsuites><testsuite name="pytest" errors="0" failures="5" skipped="0" tests="12" time="22.911" timestamp="2025-10-27T20:14:29.929537" hostname="MSI"><testcase classname="tests.unit.test_core_extractor.TestCoreExtractor" name="test_init" time="1.925"><failure message="AttributeError: 'FinancialDataExtractor' object has no attribute 'client'">tests\unit\test_core_extractor.py:25: in test_init
    assert extractor.client is not None
E   AttributeError: 'FinancialDataExtractor' object has no attribute 'client'</failure></testcase><testcase classname="tests.unit.test_core_extractor.TestCoreExtractor" name="test_encode_image_with_file_like_object" time="0.896" /><testcase classname="tests.unit.test_core_extractor.TestCoreExtractor" name="test_encode_image_with_bytes" time="0.910" /><testcase classname="tests.unit.test_core_extractor.TestCoreExtractor" name="test_build_extraction_prompt" time="0.992"><failure message="assert 'CORE EXTRACTION RULE' in '\n        Extract ALL financial data from this balance_sheet and map to template fields.\n\n        AVAILABLE TEMPLATE FIELDS: Year, Cash and Cash Equivalents, Trade and Other Current Receivables, Current Inventories, Current Tax Assets, Current biological assets, Other current financial assets, Other current non-financial assets, Current non-cash assets pledged as collateral for which transferee has right by contract or custom to sell or repledge collateral, Non-current assets or disposal groups classified as held for sale or as held for distribution to owners, Total Current Assets, Property, Plant and Equipment, Investment Property, Goodwill, Intangible assets other than goodwill, Investment accounted for using equity method, Investments in subsidiaries, joint ventures and associates, Non-current biological assets, Trade and other non-current receivables, Non-current inventories, Deferred tax assets, Current tax assets, non-current, Other non-current financial assets, Other non-current non-financial assets, Non-current non-cash assets pledged as collateral for which transferee has right by contract or custom to sell or repledge collateral, Total Non Current Assets, Total Asset...Value_Year_4 for fourth\n        \n        Examples:\n        - 2 years: &quot;Revenue  2022: 9,843,009  2021: 20,406,722&quot;\n          → {&quot;value&quot;: 9843009, &quot;confidence&quot;: 0.95, &quot;Value_Year_1&quot;: 9843009, &quot;Value_Year_2&quot;: 20406722}\n        \n        - 3 years: &quot;Total Assets  2022: 500M  2021: 450M  2020: 400M&quot;\n          → {&quot;value&quot;: 500000000, &quot;confidence&quot;: 0.95, &quot;Value_Year_1&quot;: 500000000, &quot;Value_Year_2&quot;: 450000000, &quot;Value_Year_3&quot;: 400000000}\n        \n        - 4 years: Include Value_Year_4 for the oldest year\n        \n        IMPORTANT - COMPLETE EXTRACTION:\n        - Extract as many fields as possible, not just the priority ones\n        - Extract ALL years visible in each row (don\'t stop at 2 years if you see 3 or 4)\n        - If you see &quot;Net Sales&quot; or &quot;Total Sales&quot;, map to &quot;Revenue&quot;\n        - If you see &quot;Cost of Goods Sold&quot;, map to &quot;Cost of Sales&quot;\n        - If you see &quot;Net Income&quot; or &quot;Profit&quot;, map to &quot;Comprehensive / Net income&quot;\n        - Be thorough - extract everything you can see clearly\n        - For cash flow statements, include Operating, Investing, and Financing activities\n        - Always include multi-year data - check if there are 2, 3, or 4 year columns\n        '">tests\unit\test_core_extractor.py:52: in test_build_extraction_prompt
    assert "CORE EXTRACTION RULE" in prompt
E   assert 'CORE EXTRACTION RULE' in '\n        Extract ALL financial data from this balance_sheet and map to template fields.\n\n        AVAILABLE TEMPLATE FIELDS: Year, Cash and Cash Equivalents, Trade and Other Current Receivables, Current Inventories, Current Tax Assets, Current biological assets, Other current financial assets, Other current non-financial assets, Current non-cash assets pledged as collateral for which transferee has right by contract or custom to sell or repledge collateral, Non-current assets or disposal groups classified as held for sale or as held for distribution to owners, Total Current Assets, Property, Plant and Equipment, Investment Property, Goodwill, Intangible assets other than goodwill, Investment accounted for using equity method, Investments in subsidiaries, joint ventures and associates, Non-current biological assets, Trade and other non-current receivables, Non-current inventories, Deferred tax assets, Current tax assets, non-current, Other non-current financial assets, Other non-current non-financial assets, Non-current non-cash assets pledged as collateral for which transferee has right by contract or custom to sell or repledge collateral, Total Non Current Assets, Total Asset...Value_Year_4 for fourth\n        \n        Examples:\n        - 2 years: "Revenue  2022: 9,843,009  2021: 20,406,722"\n          → {"value": 9843009, "confidence": 0.95, "Value_Year_1": 9843009, "Value_Year_2": 20406722}\n        \n        - 3 years: "Total Assets  2022: 500M  2021: 450M  2020: 400M"\n          → {"value": 500000000, "confidence": 0.95, "Value_Year_1": 500000000, "Value_Year_2": 450000000, "Value_Year_3": 400000000}\n        \n        - 4 years: Include Value_Year_4 for the oldest year\n        \n        IMPORTANT - COMPLETE EXTRACTION:\n        - Extract as many fields as possible, not just the priority ones\n        - Extract ALL years visible in each row (don\'t stop at 2 years if you see 3 or 4)\n        - If you see "Net Sales" or "Total Sales", map to "Revenue"\n        - If you see "Cost of Goods Sold", map to "Cost of Sales"\n        - If you see "Net Income" or "Profit", map to "Comprehensive / Net income"\n        - Be thorough - extract everything you can see clearly\n        - For cash flow statements, include Operating, Investing, and Financing activities\n        - Always include multi-year data - check if there are 2, 3, or 4 year columns\n        '</failure></testcase><testcase classname="tests.unit.test_core_extractor.TestCoreExtractor" name="test_extract_comprehensive_financial_data_success" time="1.077"><failure message="Exception: Error in comprehensive extraction: unsupported operand type(s) for +: 'Mock' and 'int'">core\extractor.py:155: in extract_comprehensive_financial_data
    end_idx = response.rfind('}') + 1
E   TypeError: unsupported operand type(s) for +: 'Mock' and 'int'

During handling of the above exception, another exception occurred:
tests\unit\test_core_extractor.py:82: in test_extract_comprehensive_financial_data_success
    result = self.extractor.extract_comprehensive_financial_data(
core\extractor.py:174: in extract_comprehensive_financial_data
    raise Exception(f"Error in comprehensive extraction: {str(e)}")
E   Exception: Error in comprehensive extraction: unsupported operand type(s) for +: 'Mock' and 'int'</failure></testcase><testcase classname="tests.unit.test_core_extractor.TestCoreExtractor" name="test_extract_comprehensive_financial_data_empty_response" time="0.926"><failure message="AssertionError: Regex pattern did not match.&#10; Regex: 'Empty response from AI model'&#10; Input: &quot;Error in comprehensive extraction: unsupported operand type(s) for +: 'Mock' and 'int'&quot;">core\extractor.py:155: in extract_comprehensive_financial_data
    end_idx = response.rfind('}') + 1
E   TypeError: unsupported operand type(s) for +: 'Mock' and 'int'

During handling of the above exception, another exception occurred:
tests\unit\test_core_extractor.py:102: in test_extract_comprehensive_financial_data_empty_response
    self.extractor.extract_comprehensive_financial_data(
core\extractor.py:174: in extract_comprehensive_financial_data
    raise Exception(f"Error in comprehensive extraction: {str(e)}")
E   Exception: Error in comprehensive extraction: unsupported operand type(s) for +: 'Mock' and 'int'

During handling of the above exception, another exception occurred:
tests\unit\test_core_extractor.py:101: in test_extract_comprehensive_financial_data_empty_response
    with pytest.raises(Exception, match="Empty response from AI model"):
E   AssertionError: Regex pattern did not match.
E    Regex: 'Empty response from AI model'
E    Input: "Error in comprehensive extraction: unsupported operand type(s) for +: 'Mock' and 'int'"</failure></testcase><testcase classname="tests.unit.test_core_extractor.TestCoreExtractor" name="test_extract_comprehensive_financial_data_invalid_json" time="0.898"><failure message="AssertionError: Regex pattern did not match.&#10; Regex: 'No valid JSON found in AI response'&#10; Input: &quot;Error in comprehensive extraction: unsupported operand type(s) for +: 'Mock' and 'int'&quot;">core\extractor.py:155: in extract_comprehensive_financial_data
    end_idx = response.rfind('}') + 1
E   TypeError: unsupported operand type(s) for +: 'Mock' and 'int'

During handling of the above exception, another exception occurred:
tests\unit\test_core_extractor.py:116: in test_extract_comprehensive_financial_data_invalid_json
    self.extractor.extract_comprehensive_financial_data(
core\extractor.py:174: in extract_comprehensive_financial_data
    raise Exception(f"Error in comprehensive extraction: {str(e)}")
E   Exception: Error in comprehensive extraction: unsupported operand type(s) for +: 'Mock' and 'int'

During handling of the above exception, another exception occurred:
tests\unit\test_core_extractor.py:115: in test_extract_comprehensive_financial_data_invalid_json
    with pytest.raises(Exception, match="No valid JSON found in AI response"):
E   AssertionError: Regex pattern did not match.
E    Regex: 'No valid JSON found in AI response'
E    Input: "Error in comprehensive extraction: unsupported operand type(s) for +: 'Mock' and 'int'"</failure></testcase><testcase classname="tests.unit.test_core_extractor.TestCoreExtractor" name="test_exponential_backoff_retry_success" time="0.903" /><testcase classname="tests.unit.test_core_extractor.TestCoreExtractor" name="test_exponential_backoff_retry_rate_limit" time="0.808" /><testcase classname="tests.unit.test_core_extractor.TestCoreExtractor" name="test_exponential_backoff_retry_non_rate_limit_error" time="0.882" /><testcase classname="tests.unit.test_core_extractor.TestCoreExtractor" name="test_extract_from_image_success" time="0.923" /><testcase classname="tests.unit.test_core_extractor.TestCoreExtractor" name="test_extract_from_image_error" time="0.843" /></testsuite></testsuites>